## 目标
- 新增一个“自定义报表”入口与页面，不依赖 Excel 上传。
- 允许用户自定义：标题、副标题、日期格式/显隐。
- 允许用户自由添加多种图表（柱状图、饼图、折线图），并按图表类型录入数据后实时渲染。
- 数据与页面配置支持本地持久化与导入/导出。

## 与现有架构的契合
- 继续使用 `React + Vite`、`TailwindCSS` 与现有的 `recharts`。
- 沿用当前无路由的视图切换策略：在 `App.tsx` 增加一个新的视图态 `mode: 'upload' | 'dashboard' | 'custom'`。
- 保持现有样式与交互风格，减少学习成本。

## 新入口与视图切换
- 在上传页顶部/导航区增加按钮“自定义报表”，点击切换到 `custom` 视图。
- 在自定义页提供返回按钮，回到上传页或周报页。

## 页面结构（CustomDashboard）
- 顶部“页面头部编辑区”：
  - 输入框：`标题`、`副标题`。
  - 日期设置：选择日期、格式（如 `YYYY-MM-DD`、`YYYY年MM月DD日`）、是否显示。
  - 实时预览头部（与周报风格一致）。
- 中部“图表列表区”：
  - 卡片栅格展示已配置图表，每张卡标题+图表。
  - 支持编辑、删除、复制、上下移动排序。
- 底部/右侧“操作区”：
  - 新增图表：打开图表编辑器，先选择类型（柱状/饼状/折线）。
  - 保存页面配置到本地；导出/导入 JSON；一键清空配置。

## 图表类型与数据录入
- 柱状图：
  - 数据录入项：`类别`（文本） + `值`（数值）。
  - 可添加多行、支持编辑/删除；可选颜色。
- 饼状图：
  - 数据录入项：`名称`（文本） + `值`（数值）。
  - 动态添加/删除分片；颜色选择；自动显示百分比。
- 折线图：
  - 多序列支持：每个序列含 `名称` 与若干点 `x/y`。
  - `x` 支持类目或数值；`y` 为数值；支持多序列同图。

## 组件划分
- `components/CustomDashboard.tsx`：页面主容器（头部编辑、图表列表、操作区）。
- `components/ChartEditor.tsx`：根据图表类型渲染不同的动态表单（柱/饼/折线），用于新增/编辑。
- `components/ChartRenderer.tsx`：统一渲染器，基于 `recharts` 输出对应图表（复用 `MetricsCharts.tsx` 的配置风格）。
- 可选 `hooks/useLocalStorage.ts`：简化本地持久化读写逻辑。

## 类型与数据模型（扩展 `types.ts`）
- `ChartType = 'bar' | 'pie' | 'line'`
- `ChartConfig`：`id`、`type`、`title`、`data`、`options`（颜色、显示设置等）。
- `PieDataItem = { name: string; value: number }`
- `BarDataItem = { category: string; value: number }`
- `LineSeries = { name: string; points: Array<{ x: string | number; y: number }> }`
- 页面配置：`CustomDashboardConfig = { header: { title, subtitle, date, format, showDate }, charts: ChartConfig[] }`
- 本地存储 Key：`customDashboardConfig`

## 持久化与导入/导出
- 初次进入从 `localStorage` 读取配置；更新时自动保存或手动保存。
- 导出为 JSON 文件；导入时进行结构校验与兼容处理。

## 样式与交互
- 使用 TailwindCSS 类名，延续周报页面的卡片、网格与配色风格。
- 图标沿用 `lucide-react`（新增/编辑/删除/拖拽排序等）。
- 表单交互为受控组件，确保可靠的状态同步与预览渲染。

## 验证与测试
- 在开发环境启动后，验证：
  - 标题/副标题/日期的编辑与预览一致性；日期格式切换正确。
  - 三类图表的新增/编辑/删除、排序与渲染正确；Tooltip 与 Label 显示正常。
  - 本地存储的持久化与导入/导出流程可用；异常 JSON 输入有防护与提示。
- 简单响应式检查（栅格在中小屏下换行显示）。

## 交付与代码规范
- 所有新增函数与关键组件提供函数级注释（中文）。
- 按现有项目结构新增文件，不改动现有周报逻辑与服务。
- 代码中不输出敏感信息；不引入未使用的依赖。

## 可选增强（后续）
- 一键导出页面为图片/PDF（需新增 `html-to-image` 或 `dom-to-image`，再确认是否纳入）。
- 图表主题切换（浅色/深色）；图表配色模板管理。
- 多图联动（同类目高亮）；数据模板库（快速复用常用结构）。

如确认以上方案，我将按此计划实现：新增入口、页面与组件，扩展类型，完成本地持久化与图表编辑/渲染，并在关键函数处添加中文注释。